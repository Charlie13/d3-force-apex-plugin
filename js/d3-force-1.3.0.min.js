function net_gobrechts_d3_force(o,t,e,n){"use strict";function a(){}var s={version:"1.3.0"};s.dom={},s.conf={},s.data={},s.tools={},s.status={},s.events={};var s={version:"1.3.0"};return s.dom={},s.conf={},s.data={},s.tools={},s.status={},s.events={},s.tools.parseBool=function(o){switch(String(o).trim().toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case"":return!1;default:return!1}},s.tools.getSvgParentInnerWidth=function(){var o=d3.select(s.dom.svg.node().parentNode);return parseInt(o.style("width"))-parseInt(o.style("padding-left"))-parseInt(o.style("padding-right"))-2*(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)},s.dom.containerId=o||"D3Force"+Math.floor(1e6*Math.random()),s.confUser=t||{},s.conf.apexPluginId=e,s.conf.apexPageItemsToSubmit=n,s.conf.debugPrefix="D3 Force in DOM container #"+s.dom.containerId+": ",s.conf.debug=s.conf.apexPluginId&&1==apex.jQuery("#pdebug").length,s.status.forceTickCounter=0,s.status.forceStartTime=0,s.status.forceRunning=!1,s.status.graphStarted=!1,s.status.graphRendering=!1,s.status.graphReady=!1,s.status.graphOldPositions=null,s.status.translate=[0,0],s.status.scale=1,s.status.currentCustomizeMenu="nodes",s.confDefaults={minNodeRadius:{relation:"node",type:"number",val:6,options:[12,11,10,9,8,7,6,5,4,3,2,1]},maxNodeRadius:{relation:"node",type:"number",val:18,options:[36,34,32,30,28,26,24,22,20,18,16,14,12]},colorScheme:{relation:"node",type:"text",val:"color20",options:["color20","color20b","color20c","color10","direct"]},dragMode:{relation:"node",type:"bool",val:!0,options:[!0,!1]},pinMode:{relation:"node",type:"bool",val:!1,options:[!0,!1]},nodeEventToStopPinMode:{relation:"node",type:"text",val:"contextmenu",options:["none","dblclick","contextmenu"]},onNodeContextmenuPreventDefault:{relation:"node",type:"bool",val:!1,options:[!0,!1]},nodeEventToOpenLink:{relation:"node",type:"text",val:"dblclick",options:["none","click","dblclick","contextmenu"]},nodeLinkTarget:{relation:"node",type:"text",val:"_blank",options:["none","_blank","nodeID","domContainerID"]},showLabels:{relation:"node",type:"bool",val:!0,options:[!0,!1]},labelsCircular:{relation:"node",type:"bool",val:!1,options:[!0,!1]},labelDistance:{relation:"node",type:"number",val:12,options:[30,28,26,24,22,20,18,16,14,12,10,8,6,4,2]},showTooltips:{relation:"node",type:"bool",val:!0,options:[!0,!1]},tooltipPosition:{relation:"node",type:"text",val:"svgTopRight",options:["node","svgTopLeft","svgTopRight"]},alignFixedNodesToGrid:{relation:"node",type:"bool",val:!1,options:[!0,!1]},gridSize:{relation:"node",type:"number",val:50,options:[150,140,130,120,110,100,90,80,70,60,50,40,30,20,10]},linkDistance:{relation:"link",type:"number",val:80,options:[120,110,100,90,80,70,60,50,40,30,20]},showLinkDirection:{relation:"link",type:"bool",val:!0,options:[!0,!1]},showSelfLinks:{relation:"link",type:"bool",val:!0,options:[!0,!1]},selfLinkDistance:{relation:"link",type:"number",val:20,options:[30,28,26,24,22,20,18,16,14,12,10,8]},useDomParentWidth:{relation:"graph",type:"bool",val:!1,options:[!0,!1]},width:{relation:"graph",type:"number",val:500,options:[1200,1150,1100,1050,1e3,950,900,850,800,750,700,650,600,550,500,450,400,350,300]},height:{relation:"graph",type:"number",val:500,options:[1200,1150,1100,1050,1e3,950,900,850,800,750,700,650,600,550,500,450,400,350,300]},showBorder:{relation:"graph",type:"bool",val:!0,options:[!0,!1]},showLegend:{relation:"graph",type:"bool",val:!0,options:[!0,!1]},showLoadingIndicatorOnAjaxCall:{relation:"graph",type:"bool",val:!0,options:[!0,!1]},lassoMode:{relation:"graph",type:"bool",val:!1,options:[!0,!1]},zoomMode:{relation:"graph",type:"bool",val:!1,options:[!0,!1]},minZoomFactor:{relation:"graph",type:"number",val:.2,options:[1,.9,.8,.7,.6,.5,.4,.3,.2,.1]},maxZoomFactor:{relation:"graph",type:"number",val:5,options:[10,9,8,7,6,5,4,3,2,1]},autoRefresh:{relation:"graph",type:"bool",val:!1,options:[!0,!1]},refreshInterval:{relation:"graph",type:"number",val:5e3,options:[6e4,3e4,15e3,1e4,5e3,2500]},charge:{relation:"graph",type:"number",val:-350,options:[-1e3,-950,-900,-850,-800,-750,-700,-650,-600,-550,-500,-450,-400,-350,-300,-250,-200,-150,-100,-50,0],internal:!0},gravity:{relation:"graph",type:"number",val:.1,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},linkStrength:{relation:"graph",type:"number",val:1,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},friction:{relation:"graph",type:"number",val:.9,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},theta:{relation:"graph",type:"number",val:.8,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0}},s.conf.customize=!1,s.conf.debug="undefined"!=typeof s.confUser.debug?s.tools.parseBool(s.confUser.debug):!1,s.conf.showBorder="undefined"!=typeof s.confUser.showBorder?s.tools.parseBool(s.confUser.showBorder):s.confDefaults.showBorder.val,s.conf.showLabels="undefined"!=typeof s.confUser.showLabels?s.tools.parseBool(s.confUser.showLabels):s.confDefaults.showLabels.val,s.conf.labelsCircular="undefined"!=typeof s.confUser.labelsCircular?s.tools.parseBool(s.confUser.labelsCircular):s.confDefaults.labelsCircular.val,s.conf.labelDistance=s.confUser.labelDistance||s.confDefaults.labelDistance.val,s.conf.showSelfLinks="undefined"!=typeof s.confUser.showSelfLinks?s.tools.parseBool(s.confUser.showSelfLinks):s.confDefaults.showSelfLinks.val,s.conf.showLinkDirection="undefined"!=typeof s.confUser.showLinkDirection?s.tools.parseBool(s.confUser.showLinkDirection):s.confDefaults.showLinkDirection.val,s.conf.showLegend="undefined"!=typeof s.confUser.showLegend?s.tools.parseBool(s.confUser.showLegend):s.confDefaults.showLegend.val,s.conf.showLoadingIndicatorOnAjaxCall="undefined"!=typeof s.confUser.showLoadingIndicatorOnAjaxCall?s.tools.parseBool(s.confUser.showLoadingIndicatorOnAjaxCall):s.confDefaults.showLoadingIndicatorOnAjaxCall.val,s.conf.showTooltips="undefined"!=typeof s.confUser.showTooltips?s.tools.parseBool(s.confUser.showTooltips):s.confDefaults.showTooltips.val,s.conf.tooltipPosition=s.confUser.tooltipPosition||s.confDefaults.tooltipPosition.val,s.conf.colorScheme=s.confUser.colorScheme||s.confDefaults.colorScheme.val,s.conf.dragMode="undefined"!=typeof s.confUser.dragMode?s.tools.parseBool(s.confUser.dragMode):s.confDefaults.dragMode.val,s.conf.pinMode="undefined"!=typeof s.confUser.pinMode?s.tools.parseBool(s.confUser.pinMode):s.confDefaults.pinMode.val,s.conf.nodeEventToStopPinMode=s.confUser.nodeEventToStopPinMode||s.confDefaults.nodeEventToStopPinMode.val,s.conf.lassoMode="undefined"!=typeof s.confUser.lassoMode?s.tools.parseBool(s.confUser.lassoMode):s.confDefaults.lassoMode.val,s.conf.zoomMode="undefined"!=typeof s.confUser.zoomMode?s.tools.parseBool(s.confUser.zoomMode):s.confDefaults.zoomMode.val,s.conf.minZoomFactor=s.confUser.minZoomFactor||s.confDefaults.minZoomFactor.val,s.conf.maxZoomFactor=s.confUser.maxZoomFactor||s.confDefaults.maxZoomFactor.val,s.conf.alignFixedNodesToGrid="undefined"!=typeof s.confUser.alignFixedNodesToGrid?s.tools.parseBool(s.confUser.alignFixedNodesToGrid):s.confDefaults.alignFixedNodesToGrid.val,s.conf.gridSize=s.confUser.gridSize&&s.confUser.gridSize>0?s.confUser.gridSize:s.confDefaults.gridSize.val,s.conf.onNodeContextmenuPreventDefault="undefined"!=typeof s.confUser.onNodeContextmenuPreventDefault?s.tools.parseBool(s.confUser.onNodeContextmenuPreventDefault):s.confDefaults.onNodeContextmenuPreventDefault.val,s.conf.nodeEventToOpenLink=s.confUser.nodeEventToOpenLink||s.confDefaults.nodeEventToOpenLink.val,s.conf.nodeLinkTarget=s.confUser.nodeLinkTarget||s.confDefaults.nodeLinkTarget.val,s.conf.autoRefresh="undefined"!=typeof s.confUser.autoRefresh?s.tools.parseBool(s.confUser.autoRefresh):s.confDefaults.autoRefresh.val,s.conf.refreshInterval=s.confUser.refreshInterval||s.confDefaults.refreshInterval.val,s.conf.useDomParentWidth="undefined"!=typeof s.confUser.useDomParentWidth?s.tools.parseBool(s.confUser.useDomParentWidth):s.confDefaults.useDomParentWidth.val,s.conf.width=s.confUser.width||s.confDefaults.width.val,s.conf.height=s.confUser.height||s.confDefaults.height.val,s.conf.minNodeRadius=s.confUser.minNodeRadius||s.confDefaults.minNodeRadius.val,s.conf.maxNodeRadius=s.confUser.maxNodeRadius||s.confDefaults.maxNodeRadius.val,s.conf.selfLinkDistance=s.confUser.selfLinkDistance||s.confDefaults.selfLinkDistance.val,s.conf.linkDistance=s.confUser.linkDistance||s.confDefaults.linkDistance.val,s.conf.chargeDistance=s.confUser.chargeDistance||1/0,s.conf.charge=s.confUser.charge||s.confDefaults.charge.val,s.conf.gravity=s.confUser.gravity||s.confDefaults.gravity.val,s.conf.linkStrength=s.confUser.linkStrength||s.confDefaults.linkStrength.val,s.conf.friction=s.confUser.friction||s.confDefaults.friction.val,s.conf.theta=s.confUser.theta||s.confDefaults.theta.val,s.conf.onNodeMouseenterFunction=s.confUser.onNodeMouseenterFunction||null,s.conf.onNodeMouseleaveFunction=s.confUser.onNodeMouseleaveFunction||null,s.conf.onNodeClickFunction=s.confUser.onNodeClickFunction||null,s.conf.onNodeDblclickFunction=s.confUser.onNodeDblclickFunction||null,s.conf.onNodeContextmenuFunction=s.confUser.onNodeContextmenuFunction||null,s.conf.onLassoStartFunction=s.confUser.onLassoStartFunction||null,s.conf.onLassoEndFunction=s.confUser.onLassoEndFunction||null,s.conf.currentTabPosition=null,s.conf.sampleData=!1,s.data.sampleData='<data><nodes ID="7839" LABEL="KING is THE KING, you know?" COLORVALUE="10" SIZEVALUE="5000" LABELCIRCULAR="true" LINK="http://apex.oracle.com/" INFOSTRING="This visualization is based on the well known emp table." /><nodes ID="7698" LABEL="BLAKE" COLORVALUE="30" SIZEVALUE="2850" /><nodes ID="7782" LABEL="CLARK" COLORVALUE="10" SIZEVALUE="2450" /><nodes ID="7566" LABEL="JONES" COLORVALUE="20" SIZEVALUE="2975" /><nodes ID="7788" LABEL="SCOTT" COLORVALUE="20" SIZEVALUE="3000" /><nodes ID="7902" LABEL="FORD" COLORVALUE="20" SIZEVALUE="3000" /><nodes ID="7369" LABEL="SMITH" COLORVALUE="20" SIZEVALUE="800" /><nodes ID="7499" LABEL="ALLEN" COLORVALUE="30" SIZEVALUE="1600" /><nodes ID="7521" LABEL="WARD" COLORVALUE="30" SIZEVALUE="1250" /><nodes ID="7654" LABEL="MARTIN" COLORVALUE="30" SIZEVALUE="1250" /><nodes ID="7844" LABEL="TURNER" COLORVALUE="30" SIZEVALUE="1500" /><nodes ID="7876" LABEL="ADAMS" COLORVALUE="20" SIZEVALUE="1100" /><nodes ID="7900" LABEL="JAMES" COLORVALUE="30" SIZEVALUE="950" /><nodes ID="7934" LABEL="MILLER" COLORVALUE="10" SIZEVALUE="1300" /><nodes ID="8888" LABEL="Who am I?" COLORVALUE="green" SIZEVALUE="2000" LINK="https://github.com/ogobrecht/d3-force-apex-plugin/wiki/API-Reference#nodelinktarget" INFOSTRING="This is a good question. Think about it." /><nodes ID="9999" LABEL="Where I am?" COLORVALUE="#f00" SIZEVALUE="1000" LINK="https://github.com/ogobrecht/d3-force-apex-plugin/wiki/API-Reference#nodelinktarget" INFOSTRING="This is a good question. What do you think?" /><links FROMID="7839" TOID="7839" STYLE="dashed" /><links FROMID="7698" TOID="7839" STYLE="solid" /><links FROMID="7782" TOID="7839" STYLE="solid" /><links FROMID="7566" TOID="7839" STYLE="solid" /><links FROMID="7788" TOID="7566" STYLE="solid" /><links FROMID="7902" TOID="7566" STYLE="solid" /><links FROMID="7369" TOID="7902" STYLE="solid" /><links FROMID="7499" TOID="7698" STYLE="solid" /><links FROMID="7521" TOID="7698" STYLE="solid" /><links FROMID="7654" TOID="7698" STYLE="solid" /><links FROMID="7844" TOID="7698" STYLE="solid" /><links FROMID="7876" TOID="7788" STYLE="solid" /><links FROMID="7900" TOID="7698" STYLE="solid" /><links FROMID="7934" TOID="7782" STYLE="solid" /></data>',s.dom.body=d3.select("body"),null===document.querySelector("#"+s.dom.containerId)?s.dom.container=s.dom.body.append("div").attr("id",s.dom.containerId):(s.dom.container=d3.select("#"+s.dom.containerId),d3.selectAll("#"+s.dom.containerId+"_tooltip, #"+s.dom.containerId+"_customizing").remove()),null===document.querySelector("#"+s.dom.containerId+" svg")?s.dom.svg=s.dom.container.append("svg"):(s.dom.svg=d3.select("#"+s.dom.containerId+" svg"),d3.selectAll("#"+s.dom.containerId+" svg *").remove()),s.dom.svg.attr("class","net_gobrechts_d3_force").classed("border",s.conf.showBorder).attr("width",s.conf.width).attr("height",s.conf.height),s.dom.containerWidth=s.tools.getSvgParentInnerWidth(),s.conf.useDomParentWidth&&s.dom.svg.attr("width",s.dom.containerWidth),s.dom.defs=s.dom.svg.append("defs"),s.dom.graphOverlay=s.dom.svg.append("g").attr("class","graphOverlay"),s.dom.graphOverlaySizeHelper=s.dom.graphOverlay.append("rect").attr("class","graphOverlaySizeHelper"),s.dom.graph=s.dom.graphOverlay.append("g").attr("class","graph"),s.dom.legend=s.dom.svg.append("g").attr("class","legend"),s.dom.loading=s.dom.svg.append("svg:g").attr("class","loading").style("display","none"),s.dom.loadingRect=s.dom.loading.append("svg:rect").attr("width",s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width).attr("height",s.conf.height),s.dom.loadingText=s.dom.loading.append("svg:text").attr("x",(s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width)/2).attr("y",s.conf.height/2).text("Loading..."),s.dom.defs.append("svg:marker").attr("id",s.dom.containerId+"_highlightedTriangle").attr("class","highlighted").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),s.dom.defs.append("svg:marker").attr("id",s.dom.containerId+"_normalTriangle").attr("class","normal").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),s.dom.tooltip=s.dom.container.append("div").attr("id",s.dom.containerId+"_tooltip").attr("class","net_gobrechts_d3_force_tooltip").style("top","0px").style("left","0px"),s.tools.log=function(o,t){s.conf.debug&&console.log(t?o:s.conf.debugPrefix+o),s.conf.customize&&s.dom.customizeLog&&s.dom.customizeLog.text(o+"\n"+s.dom.customizeLog.text())},s.tools.logError=function(o){console.log(s.conf.debugPrefix+"ERROR: "+o),s.conf.customize&&s.dom.customizeLog&&s.dom.customizeLog.text("ERROR: "+o+"\n"+s.dom.customizeLog.text())},s.tools.triggerApexEvent=function(o,t,e){s.conf.apexPluginId&&apex.event.trigger(o,t,e)},s.tools.setRadiusFunction=function(){s.tools.radius=d3.scale.sqrt().range([s.conf.minNodeRadius,s.conf.maxNodeRadius]).domain(d3.extent(s.data.nodes,function(o){return parseFloat(o.SIZEVALUE)}))},s.tools.setColorFunction=function(){"color20"==s.conf.colorScheme?s.tools.color=d3.scale.category20():"color20b"==s.conf.colorScheme?s.tools.color=d3.scale.category20b():"color20c"==s.conf.colorScheme?s.tools.color=d3.scale.category20c():"color10"==s.conf.colorScheme?s.tools.color=d3.scale.category10():"direct"==s.conf.colorScheme?s.tools.color=function(o){return o}:(s.conf.colorScheme="color20",s.tools.color=d3.scale.category20())},s.tools.neighboring=function(o,t){return s.data.neighbors.indexOf(o.ID+":"+t.ID)>-1||s.data.neighbors.indexOf(t.ID+":"+o.ID)>-1},s.tools.getNearestGridPosition=function(o,t){var e,n;return s.conf.zoomMode?(e=o%s.conf.gridSize,n=e>s.conf.gridSize/2?o-e+s.conf.gridSize:o-e):o>=t?(e=t%s.conf.gridSize,n=t-e,(n=t)&&(n-=s.conf.gridSize)):0>=o?n=s.conf.gridSize:(e=o%s.conf.gridSize,n=e>s.conf.gridSize/2?o-e+s.conf.gridSize:o-e,n>=t&&(n-=s.conf.gridSize)),n},s.tools.adjustSourceX=function(o){return o.source.x+Math.cos(s.tools.calcAngle(o))*o.source.radius},s.tools.adjustSourceY=function(o){return o.source.y+Math.sin(s.tools.calcAngle(o))*o.source.radius},s.tools.adjustTargetX=function(o){return o.target.x-Math.cos(s.tools.calcAngle(o))*o.target.radius},s.tools.adjustTargetY=function(o){return o.target.y-Math.sin(s.tools.calcAngle(o))*o.target.radius},s.tools.calcAngle=function(o){return Math.atan2(o.target.y-o.source.y,o.target.x-o.source.x)},s.tools.getSelfLinkPath=function(o){var t=o.source.radius,e=o.source.radius+s.conf.selfLinkDistance,n=0,a=0,r={source:{x:0,y:0,radius:t},target:{x:n+e/2,y:a+e,radius:t}},i={source:{x:n-e/2,y:a+e,radius:t},target:{x:n,y:a,radius:t}},d="M"+s.tools.adjustSourceX(r)+","+s.tools.adjustSourceY(r);return d+=" L"+(n+e/2)+","+(a+e),d+=" A"+e+","+e+" 0 0,1 "+(n-e/2)+","+(a+e),d+=" L"+s.tools.adjustTargetX(i)+","+s.tools.adjustTargetY(i)},s.tools.getLabelPath=function(o){var t=o.radius+s.conf.labelDistance,e=0,n=0,a="M"+(e-t)+","+n;return a+=" a"+t+","+t+" 0 0,1 "+2*t+",0",a+=" a"+t+","+t+" 0 0,1 -"+2*t+",0"},s.tools.openLink=function(o){var t;"none"==s.conf.nodeLinkTarget?window.location.assign(o.LINK):"nodeID"==s.conf.nodeLinkTarget?(t=window.open(o.LINK,o.ID),t.focus()):"domContainerID"==s.conf.nodeLinkTarget?(t=window.open(o.LINK,s.dom.containerId),t.focus()):(t=window.open(o.LINK,s.conf.nodeLinkTarget),t.focus())},s.tools.zoomEventProxy=function(o){return function(){s.conf.dragMode&&(!s.conf.dragMode||"circle"===d3.event.target.tagName)||!s.conf.zoomMode||d3.event.altKey||d3.event.shiftKey||o.apply(this,arguments)}},s.tools.lassoEventProxy=function(o){return function(){s.conf.dragMode&&"circle"===d3.event.target.tagName||!s.conf.lassoMode||s.conf.zoomMode&&!d3.event.altKey&&!d3.event.shiftKey||o.apply(this,arguments)}},s.tools.onNodeMouseenter=function(o){var t;s.nodes.classed("highlighted",function(t){return s.tools.neighboring(t,o)}),s.links.classed("highlighted",function(t){return t.source.ID==o.ID||t.target.ID==o.ID}).style("marker-end",function(t){return s.conf.showLinkDirection?"url(#"+s.dom.containerId+"_"+(t.source.ID==o.ID||t.target.ID==o.ID?"highlighted":"normal")+"Triangle)":null}),s.selfLinks.classed("highlighted",function(t){return t.FROMID==o.ID}).style("marker-end",function(t){return s.conf.showLinkDirection?"url(#"+s.dom.containerId+"_"+(t.source.ID==o.ID||t.target.ID==o.ID?"highlighted":"normal")+"Triangle)":null}),d3.select(this).classed("highlighted",!0),s.tools.log("Event mouseenter triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_mouseenter",o),"function"==typeof s.conf.onNodeMouseenterFunction&&s.conf.onNodeMouseenterFunction.call(this,d3.event,o),s.conf.showTooltips&&o.INFOSTRING&&(s.dom.tooltip.html(o.INFOSTRING).style("display","block"),"svgTopLeft"===s.conf.tooltipPosition?(t=s.tools.getOffsetRect(document.querySelector("#"+s.dom.containerId+" svg")),s.dom.tooltip.style("top",t.top+(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)+"px").style("left",t.left+(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)+"px")):"svgTopRight"===s.conf.tooltipPosition?(t=s.tools.getOffsetRect(document.querySelector("#"+s.dom.containerId+" svg")),s.dom.tooltip.style("top",t.top+parseInt(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)+"px").style("left",t.left+parseInt(s.dom.svg.style("width"))+parseInt(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)-parseInt(s.dom.tooltip.style("width"))-2*parseInt(s.dom.tooltip.style("border-width")?parseInt(s.dom.tooltip.style("border-width")):0)-parseInt(s.dom.tooltip.style("padding-left"))-parseInt(s.dom.tooltip.style("padding-right"))+"px")):s.dom.tooltip.style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px"))},s.tools.onNodeMouseleave=function(o){s.nodes.classed("highlighted",!1),s.links.classed("highlighted",!1).style("marker-end",s.conf.showLinkDirection?"url(#"+s.dom.containerId+"_normalTriangle)":null),s.selfLinks.classed("highlighted",!1).style("marker-end",s.conf.showLinkDirection?"url(#"+s.dom.containerId+"_normalTriangle)":null),s.labels.classed("highlighted",!1),s.tools.log("Event mouseleave triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_mouseleave",o),"function"==typeof s.conf.onNodeMouseleaveFunction&&s.conf.onNodeMouseleaveFunction.call(this,d3.event,o),s.conf.showTooltips&&s.dom.tooltip.style("display","none")},s.tools.onNodeClick=function(o){return d3.event.defaultPrevented?null:(o.LINK&&"click"==s.conf.nodeEventToOpenLink&&s.tools.openLink(o),"click"==s.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",o.fixed=0),s.tools.log("Event click triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_click",o),"function"==typeof s.conf.onNodeClickFunction&&s.conf.onNodeClickFunction.call(this,d3.event,o),void 0)},s.tools.onNodeDblclick=function(o){o.LINK&&"dblclick"==s.conf.nodeEventToOpenLink&&s.tools.openLink(o),"dblclick"==s.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",o.fixed=0),s.tools.log("Event dblclick triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_dblclick",o),"function"==typeof s.conf.onNodeDblclickFunction&&s.conf.onNodeDblclickFunction.call(this,d3.event,o)},s.tools.onNodeContextmenu=function(o){s.conf.onNodeContextmenuPreventDefault&&d3.event.preventDefault(),o.LINK&&"contextmenu"==s.conf.nodeEventToOpenLink&&s.tools.openLink(o),"contextmenu"==s.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",o.fixed=0),s.tools.log("Event contextmenu triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_contextmenu",o),"function"==typeof s.conf.onNodeContextmenuFunction&&s.conf.onNodeContextmenuFunction.call(this,d3.event,o)},s.tools.onLassoStart=function(o){var t={};t.nodes=o,t.numberOfNodes=o.size(),t.numberOfSelectedNodes=0,t.idsOfSelectedNodes=null,s.tools.log("Event lassostart triggered."),s.tools.triggerApexEvent(document.querySelector("#"+s.dom.containerId),"net_gobrechts_d3_force_lassostart",t),"function"==typeof s.conf.onLassoStartFunction&&s.conf.onLassoStartFunction.call(s.dom.svg,d3.event,t)},s.tools.onLassoEnd=function(o){var t={};t.nodes=o,t.numberOfNodes=o.size(),t.numberOfSelectedNodes=0,t.idsOfSelectedNodes="",o.each(function(o){o.selected&&(t.idsOfSelectedNodes+=o.ID+":",t.numberOfSelectedNodes++)}),t.idsOfSelectedNodes=t.idsOfSelectedNodes.length>0?t.idsOfSelectedNodes.substr(0,t.idsOfSelectedNodes.length-1):null,s.tools.log("Event lassoend triggered."),s.tools.triggerApexEvent(document.querySelector("#"+s.dom.containerId),"net_gobrechts_d3_force_lassoend",t),"function"==typeof s.conf.onLassoEndFunction&&s.conf.onLassoEndFunction.call(s.dom.svg,d3.event,t)},s.tools.x2js=new X2JS({attributePrefix:"none"}),s.tools.getOffsetRect=function(o){var t=o.getBoundingClientRect(),e=document.body,n=document.documentElement,a=window.pageYOffset||n.scrollTop||e.scrollTop,s=window.pageXOffset||n.scrollLeft||e.scrollLeft,r=n.clientTop||e.clientTop||0,i=n.clientLeft||e.clientLeft||0,d=t.top+a-r,l=t.left+s-i;return{top:Math.round(d),left:Math.round(l)}},s.tools.createLegend=function(){s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width;s.data.distinctNodeColorValues.forEach(function(o,t){s.dom.legend.append("circle").attr("cx",11).attr("cy",s.conf.height-(14*(t+1)-3)).attr("r",6).style("fill",s.tools.color(o)),s.dom.legend.append("text").attr("x",21).attr("y",s.conf.height-(14*(t+1)-6)).text(o)})},s.tools.removeLegend=function(){s.dom.legend.selectAll("*").remove()},s.tools.createCustomizeLink=function(){!s.conf.customize&&(s.conf.debug||document.querySelector("#apex-dev-toolbar")||document.querySelector("#apexDevToolbar"))&&null===document.querySelector("#"+s.dom.containerId+" svg text.link")&&s.dom.svg.append("svg:text").attr("class","link").attr("x",5).attr("y",15).attr("text-anchor","start").text("Customize Me").on("click",function(){a.customize(!0)})},s.tools.removeCustomizeLink=function(){s.dom.svg.select("#"+s.dom.containerId+" svg text.link").remove()},s.tools.customizeDrag=d3.behavior.drag().on("dragstart",function(){var o=d3.mouse(document.body);s.dom.customizePosition=s.tools.getOffsetRect(document.querySelector("#"+s.dom.containerId+"_customizing")),s.dom.customizePosition.mouseLeft=o[0]-s.dom.customizePosition.left,s.dom.customizePosition.mouseTop=o[1]-s.dom.customizePosition.top}).on("drag",function(){var o=d3.mouse(document.body);s.dom.customize.style("left",Math.max(0,o[0]-s.dom.customizePosition.mouseLeft)+"px").style("top",Math.max(0,o[1]-s.dom.customizePosition.mouseTop)+"px")}).on("dragend",function(){s.dom.customizePosition=s.tools.getOffsetRect(s.dom.customize.node())}),s.tools.createCustomizeWizard=function(){if(s.conf.customize){var o,t,e,n,r,i,d,l,c=0;s.tools.removeCustomizeLink(),s.dom.customizePosition||(s.dom.customizePosition=s.tools.getOffsetRect(s.dom.svg.node()),s.dom.customizePosition.left=s.dom.customizePosition.left+s.conf.width+8),null!==document.querySelector("#"+s.dom.containerId+"_customizing")&&s.dom.customize.remove(),s.dom.customize=s.dom.body.insert("div").attr("id",s.dom.containerId+"_customizing").attr("class","net_gobrechts_d3_force_customize").style("left",s.dom.customizePosition.left+"px").style("top",s.dom.customizePosition.top+"px"),s.dom.customize.append("span").attr("class","drag").call(s.tools.customizeDrag).append("span").attr("class","title").text('Customize "'+s.dom.containerId+'"'),s.dom.customize.append("a").attr("class","close focus").attr("tabindex",1).text("Close").on("click",function(){s.conf.customize=!1,s.tools.removeCustomizeWizard(),s.tools.createCustomizeLink()}).on("keydown",function(){13==d3.event.keyCode&&(s.conf.customize=!1,s.tools.removeCustomizeWizard(),s.tools.createCustomizeLink())}),o=s.dom.customize.append("table"),t=o.append("tr"),e=t.append("td").style("vertical-align","top"),s.dom.customizeMenu=e.append("span"),s.dom.customizeOptionsTable=e.append("table");for(var u in s.confDefaults)s.confDefaults.hasOwnProperty(u)&&(c+=1,n=s.dom.customizeOptionsTable.append("tr").attr("class",s.confDefaults[u].relation+"-related"),n.append("td").attr("class","label").html('<a href="https://github.com/ogobrecht/d3-force-apex-plugin/wiki/API-Reference#'+u.toLowerCase()+'" target="github_d3_force" tabindex="'+c+'100">'+u+"</a>"),r=n.append("td"),i=r.append("select").attr("id",s.dom.containerId+"_"+u).attr("name",u).attr("value",s.conf[u]).attr("tabindex",c+1).classed("warning",s.confDefaults[u].internal).on("change",function(){s.conf.currentTabPosition=this.id,"text"==s.confDefaults[this.name].type?a[this.name](this.options[this.selectedIndex].value).render():"number"==s.confDefaults[this.name].type?a[this.name](parseFloat(this.options[this.selectedIndex].value)).render():"bool"==s.confDefaults[this.name].type&&a[this.name]("true"==this.options[this.selectedIndex].value).render()}),l=!1,s.confDefaults[u].options.forEach(function(o){d=o,i.append("option").attr("value",o).attr("selected",function(){return"text"==s.confDefaults[u].type||"bool"==s.confDefaults[u].type?d==s.conf[u]?(l=!0,"selected"):null:"number"==s.confDefaults[u].type?parseFloat(d)==s.conf[u]?(l=!0,"selected"):null:void 0}).text(o)}),l||(i.append("option").attr("value",s.conf[u]).attr("selected","selected").text(s.conf[u]),s.confDefaults[u].options.push(s.conf[u])),"pinMode"==u&&r.append("a").text("release all").attr("href",null).on("click",function(){a.releaseFixedNodes().resume()}));s.dom.customizeOptionsTable.style("width",d3.select(s.dom.customizeOptionsTable).node()[0][0].clientWidth+"px"),e.append("span").html("<br>"),e=t.append("td").style("vertical-align","top").style("padding-left","5px"),e.append("span").html("Your Configuration Object"+(s.conf.apexPluginId?'<br><span style="background-color:yellow;font-size:10px;">To save your options please copy<br>this to your plugin region attributes</span><br>':'<br><span style="background-color:yellow;font-size:10px;">Use this to initialize your graph</span><br>')),s.dom.customizeConfObject=e.append("textarea").attr("tabindex",c+2).attr("readonly","readonly"),e.append("span").html("<br><br>Current Positions<br>"),s.dom.customizePositions=e.append("textarea").attr("tabindex",c+3).attr("readonly","readonly").text(s.status.forceRunning?"Force started - wait for end event to show positions...":JSON.stringify(a.positions())),e.append("span").html("<br><br>Debug Log (descending)<br>"),s.dom.customizeLog=e.append("textarea").attr("tabindex",c+4).attr("readonly","readonly"),t=o.append("tr"),e=t.append("td").attr("colspan",2).html("Copyrights:"),t=o.append("tr"),e=t.append("td").attr("colspan",2).html('<table><tr><td style="padding-right:20px;"><a href="https://github.com/ogobrecht/d3-force-apex-plugin" target="github_d3_force" tabindex="'+(c+5)+'">D3 Force APEX Plugin</a> ('+s.version+')<br>Ottmar Gobrecht</td><td style="padding-right:20px;"><a href="http://d3js.org" target="d3js_org" tabindex="'+(c+6)+'">D3.js</a> ('+d3.version+')<br>Mike Bostock</td><td><a href="https://code.google.com/p/x2js/" target="code_google_com" tabindex="'+(c+7)+'">X2JS</a> ('+s.tools.x2js.getVersion()+" modified)<br>Abdulla Abdurakhmanov</td></tr></table>"),s.tools.createCustomizeMenu(s.status.currentCustomizeMenu),s.tools.createCustomizingConfObject(),s.conf.currentTabPosition&&document.getElementById(s.conf.currentTabPosition).focus()}else s.tools.removeCustomizeWizard(),s.tools.createCustomizeLink()},s.tools.removeCustomizeWizard=function(){d3.select("#"+s.dom.containerId+"_customizing").remove()},s.tools.createCustomizeMenu=function(o){s.status.currentCustomizeMenu=o,s.dom.customizeMenu.selectAll("*").remove(),s.dom.customizeMenu.append("span").text("Show options for:"),"nodes"==s.status.currentCustomizeMenu?(s.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("NODES"),s.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.link-related,tr.graph-related").classed("hidden",!0)):s.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("NODES").on("click",function(){s.tools.createCustomizeMenu("nodes"),s.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.link-related,tr.graph-related").classed("hidden",!0)}),"links"==s.status.currentCustomizeMenu?(s.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("LINKS"),s.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.graph-related").classed("hidden",!0)):s.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("LINKS").on("click",function(){s.tools.createCustomizeMenu("links"),s.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.graph-related").classed("hidden",!0)}),"graph"==s.status.currentCustomizeMenu?(s.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("GRAPH"),s.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related").classed("hidden",!0)):s.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("GRAPH").on("click",function(){s.tools.createCustomizeMenu("graph"),s.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related").classed("hidden",!0)}),s.dom.customizeMenu.append("span").html("<br><br>")},s.tools.createCustomizingConfObject=function(){var o="{\n";for(var t in s.confDefaults)s.confDefaults.hasOwnProperty(t)&&(o+="range"==s.confDefaults[t].type||"number"==s.confDefaults[t].type||"bool"==s.confDefaults[t].type?'"'+t+'":'+s.conf[t]+",\n":'"'+t+'":"'+s.conf[t]+'",\n');o=o.substr(0,o.length-2)+"\n}",s.dom.customizeConfObject.text(o)},s.conf.userAgent=navigator.userAgent,s.conf.userAgent_IE_9_to_11=!1,(-1!==navigator.appVersion.indexOf("MSIE 9")||-1!==navigator.appVersion.indexOf("MSIE 10")||-1!==s.conf.userAgent.indexOf("Trident")&&-1!==s.conf.userAgent.indexOf("rv:11"))&&(s.conf.userAgent_IE_9_to_11=!0,s.tools.logError("Houston, we have a problem - user agent is IE 9, 10 or 11 - we have to provide a fix for markers: http://stackoverflow.com/questions/15588478/internet-explorer-10-not-showing-svg-path-d3-js-graph")),s.force=d3.layout.force().on("start",function(){s.tools.log("Force started."),s.conf.customize&&s.dom.customizePositions&&s.dom.customizePositions.text("Force started - wait for end event to show positions..."),s.status.forceTickCounter=0,s.status.forceStartTime=(new Date).getTime(),s.status.forceRunning=!0
}).on("tick",function(){s.conf.userAgent_IE_9_to_11&&s.conf.showLinkDirection&&(s.links.each(function(){this.parentNode.insertBefore(this,this)}),s.selfLinks.each(function(){this.parentNode.insertBefore(this,this)})),s.selfLinks.attr("transform",function(o){return"translate("+o.source.x+","+o.source.y+")"}),s.links.attr("x1",function(o){return s.tools.adjustSourceX(o)}).attr("y1",function(o){return s.tools.adjustSourceY(o)}).attr("x2",function(o){return s.tools.adjustTargetX(o)}).attr("y2",function(o){return s.tools.adjustTargetY(o)}),s.conf.showLabels&&(s.labels.attr("x",function(o){return o.x}).attr("y",function(o){return o.y-o.radius-s.conf.labelDistance}),s.labelPaths.attr("transform",function(o){return"translate("+o.x+","+o.y+")"})),s.nodes.attr("cx",function(o){return o.x}).attr("cy",function(o){return o.y}),s.status.forceTickCounter+=1}).on("end",function(){s.status.forceRunning=!1;var o=(new Date).getTime()-s.status.forceStartTime,t=(o/1e3).toFixed(1),e=Math.round(s.status.forceTickCounter/(o/1e3)),n=Math.round(o/s.status.forceTickCounter);s.conf.customize&&s.dom.customizePositions&&s.dom.customizePositions.text(JSON.stringify(a.positions())),s.tools.log("Force ended."),s.tools.log(t+" seconds, "+s.status.forceTickCounter+" ticks to cool down ("+e+" ticks/s, "+n+" ms/tick).")}),s.drag=s.force.drag(),s.lasso=d3.lasso().closePathDistance(100).closePathSelect(!0).hoverSelect(!0).area(s.dom.graphOverlay).pathContainer(s.dom.svg),s.zoom=d3.behavior.zoom(),a.start=function(o){var t;return o?a.render(o):s.conf.apexPluginId?(s.conf.showLoadingIndicatorOnAjaxCall&&a.showLoadingIndicator(!0),apex.server.plugin(s.conf.apexPluginId,{p_debug:$v("pdebug"),pageItems:s.conf.apexPageItemsToSubmit.split(",")},{success:function(o){s.conf.showLoadingIndicatorOnAjaxCall&&a.showLoadingIndicator(!1),t=o.trim().substr(0,1),"<"==t||"{"==t?a.render(o):"no_query_defined"==o.trim().substr(0,16)?(a.render(),s.tools.logError("No query defined.")):"query_returned_no_data"==o.trim().substr(0,22)?(a.render('{"data":{"nodes":[{"ID":"1","LABEL":"ERROR: No data.","COLORVALUE":"1","SIZEVALUE":"1"}],"links":[]}}'),s.tools.logError("Query returned no data.")):(a.render('{"data":{"nodes":[{"ID":"1","LABEL":"ERROR: '+o+'.","COLORVALUE":"1","SIZEVALUE":"1"}],"links":[]}}'),s.tools.logError(o))},error:function(o,t,e){a.render('{"data":{"nodes":[{"ID":"1","LABEL":"AJAX call terminated with errors.","COLORVALUE":"1","SIZEVALUE":"1"}],"links":[]}}'),s.tools.logError("AJAX call terminated with errors: "+e+".")},dataType:"text"})):a.render(),a},a.render=function(o){var t;if(s.status.graphStarted=!0,s.status.graphRendering=!0,s.tools.triggerApexEvent(document.querySelector("#"+s.dom.containerId),"apexbeforerefresh"),o||s.status.graphReady?o&&(s.conf.sampleData=!1):(s.tools.logError("Houston, we have a problem - we have to provide sample data."),s.conf.sampleData=!0,o=s.data.sampleData),o){if(s.status.graphReady&&(s.status.graphOldPositions=a.positions()),o.constructor===Object)s.data.dataConverted=o,s.conf.debug&&(s.tools.log("Data object:"),s.tools.log(s.data.dataConverted,!0));else if(o.constructor===String){if("<"==o.trim().substr(0,1))try{s.data.dataConverted=s.tools.x2js.xml_str2json(o),null===s.data.dataConverted&&(t="Unable to convert XML string.",s.tools.logError(t),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}})}catch(e){t="Unable to convert XML string: "+e.message+".",s.tools.logError(t),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}}else if("{"==o.trim().substr(0,1))try{s.data.dataConverted=JSON.parse(o)}catch(e){t="Unable to parse JSON string: "+e.message+".",s.tools.logError(t),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}}else t='Your data string is not starting with "<" or "{" - parsing not possible.',s.tools.logError(t),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}};s.conf.debug&&(s.tools.log("Data string:"),s.tools.log(o,!0),s.tools.log("Converted data object:"),s.tools.log(s.data.dataConverted,!0))}else t="Unable to parse your data - input data can be a XML string, JSON string or JavaScript object.",s.tools.logError(t),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}};null!==s.data.dataConverted?s.data.dataConverted.hasOwnProperty("data")&&null!==s.data.dataConverted.data?(s.data.dataConverted.data.hasOwnProperty("nodes")&&null!==s.data.dataConverted.data.nodes?(s.data.nodes=s.data.dataConverted.data.nodes,0==s.data.nodes.length&&(t="Your data contains an empty nodes array.",s.tools.logError(t),s.data.nodes=[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}])):(t="Your data contains no nodes.",s.tools.logError(t),s.data.nodes=[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}]),s.data.links=s.data.dataConverted.data.hasOwnProperty("links")&&null!==s.data.dataConverted.data.links?s.data.dataConverted.data.links:[]):(t="Missing root element named data.",s.tools.logError(t),s.data={nodes:[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}):(t="Unable to parse your data - please consult the API reference for possible data formats.",s.tools.logError(t),s.data={nodes:[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}),s.data.id_lookup=[],s.data.nodes.forEach(function(o){o.SIZEVALUE=parseFloat(o.SIZEVALUE),o.LABELCIRCULAR=s.tools.parseBool(o.LABELCIRCULAR),o.fixed&&(o.fixed=s.tools.parseBool(o.fixed)),o.x&&(o.x=parseFloat(o.x)),o.y&&(o.y=parseFloat(o.y)),s.data.id_lookup[o.ID]=o}),s.data.links.forEach(function(o){o.source=s.data.id_lookup[o.FROMID],o.target=s.data.id_lookup[o.TOID]}),s.data.links=s.data.links.filter(function(o){return"undefined"!=typeof o.source&&"undefined"!=typeof o.target}),s.data.neighbors=s.data.links.map(function(o){return o.FROMID+":"+o.TOID}),s.data.distinctNodeColorValues=s.data.nodes.map(function(o){return o.COLORVALUE}).filter(function(o,t,e){return e.indexOf(o)===t}).sort(function(o,t){var e=o.toLowerCase(),n=t.toLowerCase();return n>e?1:e>n?-1:0}),s.conf.positions?s.conf.positions.constructor===Array?s.conf.positions.forEach(function(o){void 0!==s.data.id_lookup[o.ID]&&(s.data.id_lookup[o.ID].fixed||(s.data.id_lookup[o.ID].fixed=o.fixed),s.data.id_lookup[o.ID].x||(s.data.id_lookup[o.ID].x=s.data.id_lookup[o.ID].px=o.x),s.data.id_lookup[o.ID].y||(s.data.id_lookup[o.ID].y=s.data.id_lookup[o.ID].py=o.y))}):s.tools.logError("Unable to set node positions: positions method parameter must be an array of node positions"):s.status.graphOldPositions&&s.status.graphOldPositions.forEach(function(o){void 0!==s.data.id_lookup[o.ID]&&(s.data.id_lookup[o.ID].fixed||(s.data.id_lookup[o.ID].fixed=o.fixed),s.data.id_lookup[o.ID].x||(s.data.id_lookup[o.ID].x=s.data.id_lookup[o.ID].px=o.x),s.data.id_lookup[o.ID].y||(s.data.id_lookup[o.ID].y=s.data.id_lookup[o.ID].py=o.y))}),s.conf.positions=null,s.status.graphOldPositions=null}return s.tools.setColorFunction(),s.tools.setRadiusFunction(),s.data.nodes.forEach(function(o){o.radius=s.tools.radius(o.SIZEVALUE)}),s.links=s.dom.graph.selectAll("line.link").data(s.data.links.filter(function(o){return o.FROMID!=o.TOID}),function(o){return o.FROMID+"_"+o.TOID}),s.links.enter().append("svg:line").attr("class","link"),s.links.exit().remove(),s.links.style("marker-end",s.conf.showLinkDirection?"url(#"+s.dom.containerId+"_normalTriangle)":null).classed("dashed",function(o){return"dashed"===o.STYLE}),s.selfLinks=s.dom.graph.selectAll("path.link").data(s.data.links.filter(function(o){return o.FROMID==o.TOID&&s.conf.showSelfLinks}),function(o){return o.FROMID+"_"+o.TOID}),s.selfLinks.enter().append("svg:path").attr("id",function(o){return s.dom.containerId+"_link_"+o.FROMID+"_"+o.TOID}).attr("class","link"),s.selfLinks.exit().remove(),s.selfLinks.attr("d",function(o){return s.tools.getSelfLinkPath(o)}).style("marker-end",s.conf.showLinkDirection?"url(#"+s.dom.containerId+"_normalTriangle)":null).classed("dashed",function(o){return"dashed"==o.STYLE}),s.patterns=s.dom.defs.selectAll("pattern").data(s.data.nodes.filter(function(o){return o.IMAGE?!0:!1}),function(o){return o.ID}),s.patterns.enter().append("svg:pattern").attr("id",function(o){return s.dom.containerId+"_pattern_"+o.ID}).append("svg:image"),s.patterns.exit().remove(),s.patterns.each(function(){d3.select(this).attr("x",0).attr("y",0).attr("height",function(o){return 2*o.radius}).attr("width",function(o){return 2*o.radius}),d3.select(this.firstChild).attr("x",0).attr("y",0).attr("height",function(o){return 2*o.radius}).attr("width",function(o){return 2*o.radius}).attr("xlink:href",function(o){return o.IMAGE})}),s.nodes=s.dom.graph.selectAll("circle.node").data(s.data.nodes,function(o){return o.ID}),s.nodes.enter().append("svg:circle").attr("class","node").attr("cx",function(o){return o.x=Math.floor(Math.random()*(s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width)+1)}).attr("cy",function(o){return o.y=Math.floor(Math.random()*s.conf.height+1)}).on("mouseenter",s.tools.onNodeMouseenter).on("mouseleave",s.tools.onNodeMouseleave).on("click",s.tools.onNodeClick).on("dblclick",s.tools.onNodeDblclick).on("contextmenu",s.tools.onNodeContextmenu),s.nodes.exit().remove(),s.nodes.attr("r",function(o){return o.radius}).style("fill",null).style("fill",function(o){return o.IMAGE?"url(#"+s.dom.containerId+"_pattern_"+o.ID+")":s.tools.color(o.COLORVALUE)}),s.conf.showLabels?(s.labels=s.dom.graph.selectAll("text.label").data(s.data.nodes.filter(function(o){return!o.LABELCIRCULAR&&!s.conf.labelsCircular}),function(o){return o.ID}),s.labels.enter().append("svg:text").attr("class","label"),s.labels.exit().remove(),s.labels.text(function(o){return o.LABEL}),s.labelPaths=s.dom.defs.selectAll("path.label").data(s.data.nodes.filter(function(o){return o.LABELCIRCULAR||s.conf.labelsCircular}),function(o){return o.ID}),s.labelPaths.enter().append("svg:path").attr("id",function(o){return s.dom.containerId+"_textPath_"+o.ID}).attr("class","label"),s.labelPaths.exit().remove(),s.labelPaths.attr("d",function(o){return s.tools.getLabelPath(o)}),s.labelsCircular=s.dom.graph.selectAll("text.labelCircular").data(s.data.nodes.filter(function(o){return o.LABELCIRCULAR||s.conf.labelsCircular}),function(o){return o.ID}),s.labelsCircular.enter().append("svg:text").attr("class","labelCircular").append("svg:textPath").attr("xlink:href",function(o){return"#"+s.dom.containerId+"_textPath_"+o.ID}),s.labelsCircular.exit().remove(),s.labelsCircular.each(function(o){d3.select(this.firstChild).text(o.LABEL)})):(s.dom.defs.selectAll("path.label").remove(),s.dom.graph.selectAll("text.label,text.labelCircular").remove()),a.debug(s.conf.debug).showBorder(s.conf.showBorder).useDomParentWidth(s.conf.useDomParentWidth).width(s.conf.width).height(s.conf.height).alignFixedNodesToGrid(s.conf.alignFixedNodesToGrid).dragMode(s.conf.dragMode).pinMode(s.conf.pinMode).lassoMode(s.conf.lassoMode).zoomMode(s.conf.zoomMode).autoRefresh(s.conf.autoRefresh).linkDistance(s.conf.linkDistance).charge(s.conf.charge).chargeDistance(s.conf.chargeDistance).gravity(s.conf.gravity).linkStrength(s.conf.linkStrength).friction(s.conf.friction).theta(s.conf.theta),s.force.nodes(s.data.nodes).links(s.data.links).start(),s.conf.customize?s.tools.createCustomizeWizard():s.tools.createCustomizeLink(),s.status.graphReady=!0,s.status.graphRendering=!1,s.tools.triggerApexEvent(document.querySelector("#"+s.dom.containerId),"apexafterrefresh"),a},a.resume=function(){return s.force.resume(),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a},a.showBorder=function(o){return arguments.length?(s.conf.showBorder=o,s.status.graphStarted&&(s.dom.svg.classed("border",s.conf.showBorder),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.showBorder},a.showLegend=function(o){return arguments.length?(s.conf.showLegend=o,s.status.graphStarted&&(s.conf.showLegend?(s.tools.removeLegend(),s.tools.createLegend()):s.tools.removeLegend(),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.showLegend},a.showSelfLinks=function(o){return arguments.length?(s.conf.showSelfLinks=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.showSelfLinks},a.showLinkDirection=function(o){return arguments.length?(s.conf.showLinkDirection=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.showLinkDirection},a.showTooltips=function(o){return arguments.length?(s.conf.showTooltips=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.showTooltips},a.tooltipPosition=function(o){return arguments.length?(s.conf.tooltipPosition=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.tooltipPosition},a.colorScheme=function(o){return arguments.length?(s.conf.colorScheme=o,s.status.graphStarted&&(s.tools.setColorFunction(),s.nodes.style("fill",null).style("fill",function(o){return o.IMAGE?"url(#"+s.dom.containerId+"_pattern_"+o.ID+")":s.tools.color(o.COLORVALUE)}),s.conf.showLegend&&(s.tools.removeLegend(),s.tools.createLegend()),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.colorScheme},a.showLabels=function(o){return arguments.length?(s.conf.showLabels=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.showLabels},a.labelsCircular=function(o){return arguments.length?(s.conf.labelsCircular=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.labelsCircular},a.dragMode=function(o){return arguments.length?(s.conf.dragMode=o,s.status.graphStarted&&(s.conf.dragMode?s.nodes.call(s.drag):(s.nodes.on("mousedown.drag",null),s.nodes.on("touchstart.drag",null)),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.dragMode},a.pinMode=function(o){return arguments.length?(s.conf.pinMode=o,s.status.graphStarted&&(s.conf.pinMode?s.drag.on("dragstart",function(o){d3.select(this).classed("fixed",o.fixed=1)}):s.drag.on("dragstart",null),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.pinMode},a.lassoMode=function(o){return arguments.length?(s.conf.lassoMode=o,s.status.graphStarted&&(s.conf.lassoMode?(s.dom.graphOverlay.call(s.lasso),s.lasso.items(s.nodes),s.lasso.on("start",function(){s.lasso.items().classed("selected",!1),s.tools.onLassoStart(s.lasso.items())}),s.lasso.on("draw",function(){s.lasso.items().filter(function(o){return o.possible===!0}).classed("selected",!0),s.lasso.items().filter(function(o){return o.possible===!1}).classed("selected",!1)}),s.lasso.on("end",function(){s.lasso.items().filter(function(o){return o.selected===!0}).classed("selected",!0),s.lasso.items().filter(function(o){return o.selected===!1}).classed("selected",!1),s.tools.onLassoEnd(s.lasso.items())}),s.events.mousedownLasso=s.dom.graphOverlay.on("mousedown.drag"),s.events.touchstartLasso=s.dom.graphOverlay.on("touchstart.drag"),s.dom.graphOverlay.on("mousedown.drag",s.tools.lassoEventProxy(s.events.mousedownLasso)),s.dom.graphOverlay.on("touchstart.drag",s.tools.lassoEventProxy(s.events.touchstartLasso))):(s.dom.graphOverlay.on(".drag",null),s.nodes.classed("selected",!1)),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.lassoMode},a.zoomMode=function(o){return arguments.length?(s.conf.zoomMode=o,s.status.graphStarted&&(s.conf.zoomMode?(s.dom.graphOverlay.call(s.zoom),s.zoom.scaleExtent([s.conf.minZoomFactor,s.conf.maxZoomFactor]).translate(s.status.translate).scale(s.status.scale).size([s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width,s.conf.height]).on("zoom",function(){s.status.translate=d3.event.translate,s.status.scale=d3.event.scale,s.dom.graph.attr("transform","translate("+s.status.translate+")scale("+s.status.scale+")")}),s.events.dblclickZoom=s.dom.graphOverlay.on("dblclick.zoom"),s.events.mousedownZoom=s.dom.graphOverlay.on("mousedown.zoom"),s.events.touchstartZoom=s.dom.graphOverlay.on("touchstart.zoom"),s.dom.graphOverlay.on("dblclick.zoom",s.tools.zoomEventProxy(s.events.dblclickZoom)),s.dom.graphOverlay.on("mousedown.zoom",s.tools.zoomEventProxy(s.events.mousedownZoom)),s.dom.graphOverlay.on("touchstart.zoom",s.tools.zoomEventProxy(s.events.touchstartZoom))):(s.dom.graphOverlay.on(".zoom",null),s.dom.graph.attr("transform","translate(0,0)scale(1)")),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.zoomMode},a.minZoomFactor=function(o){return arguments.length?(s.conf.minZoomFactor=o,s.status.graphReady&&a.zoomMode(s.conf.zoomMode),a):s.conf.minZoomFactor},a.maxZoomFactor=function(o){return arguments.length?(s.conf.maxZoomFactor=o,s.status.graphReady&&a.zoomMode(s.conf.zoomMode),a):s.conf.maxZoomFactor},a.zoom=function(o,t,e){if(s.conf.zoomMode){var n=s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width;o||(o=n/2),t||(t=s.conf.height/2),e||(e=n),s.status.scale=n/e,s.status.scale<s.conf.minZoomFactor&&(s.status.scale=s.conf.minZoomFactor),s.status.scale>s.conf.maxZoomFactor&&(s.status.scale=s.conf.maxZoomFactor),s.status.translate=[n/2-o*s.status.scale,s.conf.height/2-t*s.status.scale],s.zoom.translate(s.status.translate).scale(s.status.scale).event(s.dom.graphOverlay)}return a},a.zoomSmooth=function(o,t,e,n){if(s.conf.zoomMode){var r=s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width;o||(o=r/2),t||(t=s.conf.height/2),e||(e=r),n||(n=1500),s.status.scale=r/e,s.status.scale<s.conf.minZoomFactor&&(s.status.scale=s.conf.minZoomFactor),s.status.scale>s.conf.maxZoomFactor&&(s.status.scale=s.conf.maxZoomFactor),s.status.translate=[r/2-o*s.status.scale,s.conf.height/2-t*s.status.scale],s.dom.graphOverlay.transition().duration(n).call(s.zoom.translate(s.status.translate).scale(s.status.scale).event)}return a},a.showLoadingIndicatorOnAjaxCall=function(o){return arguments.length?(s.conf.showLoadingIndicatorOnAjaxCall=o,a):s.conf.showLoadingIndicatorOnAjaxCall},a.showLoadingIndicator=function(o){return s.tools.parseBool(o)?s.dom.loading.style("display","block"):s.dom.loading.style("display","none"),a},a.alignFixedNodesToGrid=function(o){return arguments.length?(s.conf.alignFixedNodesToGrid=o,s.status.graphStarted&&(s.conf.alignFixedNodesToGrid?(s.nodes.each(function(o){o.fixed&&(o.x=o.px=s.tools.getNearestGridPosition(o.x,s.conf.width),o.y=o.py=s.tools.getNearestGridPosition(o.y,s.conf.height))}),s.drag.on("dragend",function(o){o.x=o.px=s.tools.getNearestGridPosition(o.x,s.conf.width),o.y=o.py=s.tools.getNearestGridPosition(o.y,s.conf.height)})):s.drag.on("dragend",null),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.alignFixedNodesToGrid},a.moveFixedNodes=function(o,t){return s.status.graphStarted&&(o||(o=0),t||(t=0),(0!=o||0!=t)&&s.nodes.each(function(e){e.fixed&&(e.x=e.px=s.conf.alignFixedNodesToGrid?s.tools.getNearestGridPosition(e.x+o,s.conf.width):e.x+o,e.y=e.py=s.conf.alignFixedNodesToGrid?s.tools.getNearestGridPosition(e.y+t,s.conf.width):e.y+t)})),a},a.gridSize=function(o){return arguments.length?(s.conf.gridSize=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.gridSize},a.nodeEventToStopPinMode=function(o){return arguments.length?(s.conf.nodeEventToStopPinMode=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.nodeEventToStopPinMode},a.onNodeContextmenuPreventDefault=function(o){return arguments.length?(s.conf.onNodeContextmenuPreventDefault=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.onNodeContextmenuPreventDefault},a.nodeEventToOpenLink=function(o){return arguments.length?(s.conf.nodeEventToOpenLink=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.nodeEventToOpenLink},a.nodeLinkTarget=function(o){return arguments.length?(s.conf.nodeLinkTarget=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.nodeLinkTarget},a.autoRefresh=function(o){return arguments.length?(s.conf.autoRefresh=o,s.status.graphStarted&&(s.conf.autoRefresh&&s.conf.refreshInterval&&!s.conf.interval?(s.conf.interval=window.setInterval(function(){a.start()},s.conf.refreshInterval),s.tools.log("Auto refresh started with an interval of "+s.conf.refreshInterval+" milliseconds.")):!s.conf.autoRefresh&&s.conf.interval&&(clearInterval(s.conf.interval),s.conf.interval=null,s.tools.log("Auto refresh stopped.")),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.autoRefresh},a.refreshInterval=function(o){return arguments.length?(s.conf.refreshInterval=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.refreshInterval},a.useDomParentWidth=function(o){return arguments.length?(s.conf.useDomParentWidth=o,s.status.graphStarted&&(s.conf.useDomParentWidth?(s.dom.containerWidth=s.tools.getSvgParentInnerWidth(),d3.select(window).on("resize",function(){var o=s.dom.containerWidth,t=s.tools.getSvgParentInnerWidth();o!==t&&(s.dom.containerWidth=t,a.width(s.conf.width).resume())})):d3.select(window).on("resize",null),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.useDomParentWidth},a.domParentWidth=function(){return s.dom.containerWidth||s.tools.getSvgParentInnerWidth()},a.width=function(o){return arguments.length?(s.conf.width=o,s.status.graphStarted&&(s.dom.svg.attr("width",s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width),s.dom.graphOverlaySizeHelper.attr("width",s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width),s.dom.loadingRect.attr("width",s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width),s.dom.loadingText.attr("x",(s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width)/2),s.force.size([s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width,s.conf.height]),s.conf.zoomMode&&s.zoom.size([s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width,s.conf.height]),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.width},a.height=function(o){return arguments.length?(s.conf.height=o,s.status.graphStarted&&(s.dom.svg.attr("height",s.conf.height),s.dom.graphOverlaySizeHelper.attr("height",s.conf.height),s.dom.loadingRect.attr("height",s.conf.height),s.dom.loadingText.attr("y",s.conf.height/2),s.force.size([s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width,s.conf.height]),s.conf.showLegend&&(s.tools.removeLegend(),s.tools.createLegend()),s.conf.zoomMode&&s.zoom.size([s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width,s.conf.height]),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.height},a.minNodeRadius=function(o){return arguments.length?(s.conf.minNodeRadius=o,s.status.graphReady&&(s.tools.setRadiusFunction(),s.nodes.each(function(o){o.radius=s.tools.radius(o.SIZEVALUE)}),s.nodes.attr("r",function(o){return o.radius}),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.minNodeRadius},a.maxNodeRadius=function(o){return arguments.length?(s.conf.maxNodeRadius=o,s.status.graphReady&&(s.tools.setRadiusFunction(),s.nodes.each(function(o){o.radius=s.tools.radius(o.SIZEVALUE)}),s.nodes.attr("r",function(o){return o.radius}),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.maxNodeRadius},a.labelDistance=function(o){return arguments.length?(s.conf.labelDistance=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.labelDistance},a.selfLinkDistance=function(o){return arguments.length?(s.conf.selfLinkDistance=o,s.status.graphStarted&&s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard(),a):s.conf.selfLinkDistance},a.linkDistance=function(o){return arguments.length?(s.conf.linkDistance=o,s.status.graphStarted&&(s.force.linkDistance(s.conf.linkDistance),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.linkDistance},a.charge=function(o){return arguments.length?(s.conf.charge=o,s.status.graphStarted&&(s.force.charge(s.conf.charge),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.charge},a.chargeDistance=function(o){return arguments.length?(s.conf.chargeDistance=o,s.status.graphStarted&&(s.force.chargeDistance(s.conf.chargeDistance),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.chargeDistance},a.gravity=function(o){return arguments.length?(s.conf.gravity=o,s.status.graphStarted&&(s.force.gravity(s.conf.gravity),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.gravity},a.linkStrength=function(o){return arguments.length?(s.conf.linkStrength=o,s.status.graphStarted&&(s.force.linkStrength(s.conf.linkStrength),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.linkStrength},a.friction=function(o){return arguments.length?(s.conf.friction=o,s.status.graphStarted&&(s.force.friction(s.conf.friction),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.friction},a.theta=function(o){return arguments.length?(s.conf.theta=o,s.status.graphStarted&&(s.force.theta(s.conf.theta),s.conf.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()),a):s.conf.theta},a.positions=function(o){if(arguments.length)return s.status.graphReady?o.constructor===Array?o.forEach(function(o){void 0!==s.data.id_lookup[o.ID]&&(s.data.id_lookup[o.ID].fixed=s.tools.parseBool(o.fixed),s.data.id_lookup[o.ID].x=s.data.id_lookup[o.ID].px=o.x,s.data.id_lookup[o.ID].y=s.data.id_lookup[o.ID].py=o.y)}):s.tools.logError("Unable to set node positions: positions method parameter must be an array of node positions"):s.conf.positions=o,a;var t=[];return s.data.nodes.forEach(function(o){t.push({ID:o.ID,x:Math.round(o.x),y:Math.round(o.y),fixed:o.fixed?1:0})}),t},a.onNodeMouseenterFunction=function(o){return arguments.length?(s.conf.onNodeMouseenterFunction=o,a):s.conf.onNodeMouseenterFunction},a.onNodeMouseleaveFunction=function(o){return arguments.length?(s.conf.onNodeMouseleaveFunction=o,a):s.conf.onNodeMouseleaveFunction},a.onNodeClickFunction=function(o){return arguments.length?(s.conf.onNodeClickFunction=o,a):s.conf.onNodeClickFunction},a.onNodeDblclickFunction=function(o){return arguments.length?(s.conf.onNodeDblclickFunction=o,a):s.conf.onNodeDblclickFunction},a.onNodeContextmenuFunction=function(o){return arguments.length?(s.conf.onNodeContextmenuFunction=o,a):s.conf.onNodeContextmenuFunction},a.onLassoStartFunction=function(o){return arguments.length?(s.conf.onLassoStartFunction=o,a):s.conf.onLassoStartFunction},a.onLassoEndFunction=function(o){return arguments.length?(s.conf.onLassoEndFunction=o,a):s.conf.onLassoEndFunction},a.sampleData=function(o){return arguments.length?(s.data.sampleData=o,a):s.data.sampleData},a.data=function(){return s.data.dataConverted},a.nodeDataById=function(o){return s.data.id_lookup[o]},a.customize=function(o){return arguments.length?(s.conf.customize=o,s.status.graphStarted&&(s.conf.customize?s.tools.createCustomizeWizard():s.tools.removeCustomizeWizard()),a):s.conf.customize},a.debug=function(o){return arguments.length?(s.conf.debug=o,s.status.graphStarted&&(s.conf.debug?s.tools.createCustomizeLink():s.tools.removeCustomizeLink()),a):s.conf.debug},a.releaseFixedNodes=function(){return s.status.graphStarted&&s.nodes.each(function(o){o.fixed=0}),a},a.userAgent=function(){return s.conf.userAgent},a.inspect=function(){return s},a.version=function(){return s.version},s.conf.apexPluginId&&apex.jQuery("#"+s.dom.containerId).bind("apexrefresh",function(){a.start()}),a}